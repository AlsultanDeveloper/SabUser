# ููุฎุต ูุธุงู ุฅุดุนุงุฑุงุช ุงูุฏุนู
# Support Notifications System Summary

ุชู ุฅุถุงูุฉ ูุธุงู ูุงูู ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูููุณุชุฎุฏููู ุนูุฏ ุงูุฑุฏ ุนูู ุฑุณุงุฆู ุงูุฏุนู ุงูุฎุงุตุฉ ุจูู.

---

## โ ูุง ุชู ุฅุถุงูุชู

### 1. ุฏูุงู ุงูุฅุดุนุงุฑุงุช ูู `utils/notifications.ts`

ุชูุช ุฅุถุงูุฉ ุงูุฏูุงู ุงูุชุงููุฉ:

#### `sendPushNotification()`
- ุฅุฑุณุงู ุฅุดุนุงุฑ ูุฌูุงุฒ ูุงุญุฏ
- ุชูุณุชุฎุฏู ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูุฑุฏูุฉ

#### `sendBulkPushNotifications()`
- ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูุนุฏุฉ ุฃุฌูุฒุฉ
- ุชูุณุชุฎุฏู ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุฌูุงุนูุฉ

#### `notifySupportMessageReply()` โญ ุฌุฏูุฏ
- **ุงูุบุฑุถ:** ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุณุชุฎุฏู ุนูุฏ ุงูุฑุฏ ุนูู ุฑุณุงูุฉ ุงูุฏุนู
- **ุงููุฏุฎูุงุช:**
  - `supportMessageId`: ูุนุฑู ุฑุณุงูุฉ ุงูุฏุนู
  - `replyText`: ูุต ุงูุฑุฏ
- **ุงูุฅุฎุฑุงุฌ:** `true` ุฅุฐุง ุชู ุงูุฅุฑุณุงู ุจูุฌุงุญุ `false` ุฅุฐุง ูุดู

**ูุซุงู ุงูุงุณุชุฎุฏุงู:**
```typescript
import { notifySupportMessageReply } from '@/utils/notifications';

await notifySupportMessageReply('message_123', 'ุดูุฑุงู ุนูู ุชูุงุตูู!');
```

---

### 2. Firebase Cloud Functions ูู `firebase-functions-support.js`

ุชูุช ุฅุถุงูุฉ 4 ุฏูุงู ุณุญุงุจูุฉ:

#### `onSupportMessageReply` โญ ุงูุฑุฆูุณูุฉ
- **ุชุนูู ุชููุงุฆูุงู** ุนูุฏ ุชุญุฏูุซ ุฑุณุงูุฉ ุฏุนู
- ุชุฑุณู ุฅุดุนุงุฑ ูููุณุชุฎุฏู ุนูุฏ ุฅุถุงูุฉ ุฑุฏ ุฌุฏูุฏ
- ูุง ุชุญุชุงุฌ ูุฃู ุงุณุชุฏุนุงุก ูุฏูู

#### `onNewOrder`
- ุฅุฑุณุงู ุฅุดุนุงุฑ ููุฅุฏุงุฑุฉ ุนูุฏ ุทูุจ ุฌุฏูุฏ
- ูููุฏ ูููุญุฉ ุงูุชุญูู

#### `cleanupOldNotifications`
- ุญุฐู ุงูุฅุดุนุงุฑุงุช ุงููุฏููุฉ (> 30 ููู)
- ุชุนูู ุชููุงุฆูุงู ููููุงู

#### `onNewUser`
- ุฅุฑุณุงู ุฑุณุงูุฉ ุชุฑุญูุจูุฉ ูููุณุชุฎุฏููู ุงูุฌุฏุฏ
- ุชุนูู ุชููุงุฆูุงู ุนูุฏ ุงูุชุณุฌูู

---

### 3. ูููุงุช ุงูุชูุซูู

#### `SUPPORT_NOTIFICATIONS_GUIDE.md`
ุฏููู ุดุงูู ูุดุฑุญ:
- ููููุฉ ุนูู ูุธุงู ุงูุฅุดุนุงุฑุงุช
- 3 ุทุฑู ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช
- ุฃูุซูุฉ ุนูููุฉ ููุงุณุชุฎุฏุงู
- ูุนุงูุฌุฉ ุงูุฅุดุนุงุฑุงุช ูู ุงูุชุทุจูู
- Firebase Security Rules

#### `FIREBASE_FUNCTIONS_DEPLOYMENT.md`
ุฏููู ุงููุดุฑ ุงููุงูู:
- ุฎุทูุงุช ุชุซุจูุช Firebase CLI
- ููููุฉ ูุดุฑ ุงูุฏูุงู
- ุงูุงุฎุชุจุงุฑ ุงููุญูู
- ูุฑุงูุจุฉ ุงูุณุฌูุงุช
- ุงุณุชูุดุงู ุงูุฃุฎุทุงุก
- ุงูุชูุงููู ุงููุชููุนุฉ

---

## ๐ ููููุฉ ุงูุจุฏุก

### ุงูุทุฑููุฉ 1: Firebase Functions (ููุตู ุจูุง) - ุชููุงุฆู 100%

**1. ุชุซุจูุช Firebase CLI:**
```bash
npm install -g firebase-tools
firebase login
```

**2. ุชููุฆุฉ Functions:**
```bash
firebase init functions
```

**3. ูุณุฎ ุงูููุฏ:**
```bash
Copy-Item firebase-functions-support.js functions/index.js
```

**4. ุงููุดุฑ:**
```bash
cd functions
npm install
cd ..
firebase deploy --only functions
```

**5. ุชู! ๐**
ุงูุขู ุนูุฏ ุงูุฑุฏ ุนูู ุฃู ุฑุณุงูุฉ ุฏุนู ูู Firebase Consoleุ ุณูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุชููุงุฆูุงู!

---

### ุงูุทุฑููุฉ 2: ูู ููุญุฉ ุงูุชุญูู - ูุฏูู

ุฅุฐุง ูุงู ูุฏูู admin panel:

```typescript
import { notifySupportMessageReply } from '@/utils/notifications';
import { updateDocument, collections } from '@/constants/firestore';

async function handleReply(messageId, replyText) {
  // 1. ุญูุธ ุงูุฑุฏ
  await updateDocument(collections.supportMessages, messageId, {
    reply: replyText,
    status: 'replied',
    repliedAt: new Date().toISOString(),
  });
  
  // 2. ุฅุฑุณุงู ุงูุฅุดุนุงุฑ
  await notifySupportMessageReply(messageId, replyText);
}
```

---

## ๐ฑ ููู ูุนูู ุงููุธุงู

### ูููุณุชุฎุฏู:

1. **ุฅุฑุณุงู ุฑุณุงูุฉ ุฏุนู:**
   ```
   ุงููุณุชุฎุฏู ููุชุญ "ุงุชุตู ุจุงูุฏุนู" โ ููุชุจ ุฑุณุงูุชู โ ูุฑุณู
   ```

2. **ุงูุงูุชุธุงุฑ:**
   ```
   ุงูุฑุณุงูุฉ ุชูุญูุธ ูู Firestore
   ```

3. **ุงุณุชูุงู ุงูุฅุดุนุงุฑ:**
   ```
   ูุฑูู ุงูุฏุนู ูุฑุฏ โ Firebase Function ุชุฑุณู ุฅุดุนุงุฑ โ ุงููุณุชุฎุฏู ูุณุชูู
   ```

4. **ูุฑุงุกุฉ ุงูุฑุฏ:**
   ```
   ุงููุณุชุฎุฏู ูููุฑ ุนูู ุงูุฅุดุนุงุฑ โ ููุชุญ ุงูุชุทุจูู โ ูุฑู ุงูุฑุฏ
   ```

---

### ููุฅุฏุงุฑุฉ:

**ุนุจุฑ Firebase Console:**
```
1. ูุชุญ Firebase Console
2. Firestore Database โ supportMessages
3. ุงุฎุชูุงุฑ ุงูุฑุณุงูุฉ
4. ุฅุถุงูุฉ ุญูู "reply" ูุน ูุต ุงูุฑุฏ
5. ุชุญุฏูุซ "status" ุฅูู "replied"
6. ุญูุธ โ ุงูุฅุดุนุงุฑ ููุฑุณู ุชููุงุฆูุงู โ
```

**ุนุจุฑ Admin Panel (ุฅู ููุฌุฏ):**
```
1. ูุชุญ ุฑุณุงุฆู ุงูุฏุนู
2. ุงุฎุชูุงุฑ ุฑุณุงูุฉ
3. ูุชุงุจุฉ ุงูุฑุฏ
4. ุงูุถุบุท ุนูู "ุฅุฑุณุงู"
5. ุงูููุฏ ูุญูุธ ุงูุฑุฏ ููุฑุณู ุงูุฅุดุนุงุฑ ูุนุงู
```

---

## ๐ ุดูู ุงูุฅุดุนุงุฑ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ฌ ุฑุฏ ูู ูุฑูู ุงูุฏุนู | Support Reply โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุดูุฑุงู ุนูู ุชูุงุตูู ูุนูุง. ุชู ุญู       โ
โ ุงููุดููุฉ ูุณูุชู ูุนุงูุฌุฉ ุทูุจู...       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โจ ูููุฒุงุช ุงููุธุงู

- โ **ุชููุงุฆู ุจุงููุงูู** (ูุน Firebase Functions)
- โ **ุซูุงุฆู ุงููุบุฉ** (ุนุฑุจู/ุฅูุฌููุฒู)
- โ **ุณุฑูุน** (ุฅุดุนุงุฑ ููุฑู)
- โ **ุขูู** (Firebase Security Rules)
- โ **ูููุฑ** (ุถูู ุงูุญุตุฉ ุงููุฌุงููุฉ)
- โ **ูุงุจู ููุชูุณุน** (ูุฏุนู ุขูุงู ุงููุณุชุฎุฏููู)

---

## ๐ ุงูุจูุงูุงุช ุงููุทููุจุฉ

### ูู `users` collection:
```json
{
  "uid": "user_123",
  "email": "user@example.com",
  "pushToken": "ExponentPushToken[xxx]",  โ ูุทููุจ ููุฅุดุนุงุฑุงุช
  "role": "user"  // ุฃู "admin" ููุฅุฏุงุฑุฉ
}
```

### ูู `supportMessages` collection:
```json
{
  "id": "msg_123",
  "userId": "user_123",  โ ุฑุจุท ูุน ุงููุณุชุฎุฏู
  "name": "Ahmed",
  "email": "ahmed@example.com",
  "message": "ุณุคุงูู ูู...",
  "status": "pending",  // pending โ replied โ resolved
  "read": false,
  "createdAt": "2025-10-31T10:00:00Z",
  "updatedAt": "2025-10-31T10:00:00Z",
  
  // ุชูุถุงู ุนูุฏ ุงูุฑุฏ:
  "reply": "ุงูุฌูุงุจ ูู...",
  "repliedAt": "2025-10-31T12:00:00Z"
}
```

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ูุดุฑ Firebase Functions** (ุฑุงุฌุน `FIREBASE_FUNCTIONS_DEPLOYMENT.md`)
2. **ุงุฎุชุจุงุฑ ุงููุธุงู** (ุฃุฑุณู ุฑุณุงูุฉ ุฏุนู ูุงุฎุชุจุฑ ุงูุฑุฏ)
3. **ุชุฎุตูุต ุงูุฅุดุนุงุฑุงุช** (ูููู ุชุบููุฑ ุงููุตูุต ูุงูุฃููููุงุช)
4. **ุฅุถุงูุฉ ุดุงุดุฉ ุนุฑุถ ุงูุฑุฏูุฏ** (ุงุฎุชูุงุฑู - ูุนุฑุถ ุชุงุฑูุฎ ุงููุญุงุฏุซุงุช)

---

## ๐ ุฏุนู ููู

ุฑุงุฌุน ุงููููุงุช ุงูุชุงููุฉ ูููุฒูุฏ:
- `SUPPORT_NOTIFICATIONS_GUIDE.md` - ุฏููู ุงูุฅุดุนุงุฑุงุช ุงูุดุงูู
- `FIREBASE_FUNCTIONS_DEPLOYMENT.md` - ุฏููู ุงููุดุฑ
- `NOTIFICATIONS_GUIDE.md` - ุฏููู ุนุงู ููุฅุดุนุงุฑุงุช
- `FIRESTORE_STRUCTURE.md` - ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 31 ุฃูุชูุจุฑ 2025
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู
